<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">



<ui:composition template="../WEB-INF/plantilla/layout.xhtml">

	<ui:define name="contenido">

		<h:form id="frmActProc">

			<p:panel header="Filtros de Busqueda" id="panelConsExpe">

				<h:messages globalOnly="true" />
				<h:panelGrid columns="15">
					
					<h:outputLabel value="Organo" />
					<p:selectOneMenu value="#{agendaTrab.idOrgano}" id="somOrg">
						<f:selectItem itemLabel="Seleccione" itemValue="" />
						<f:selectItems value="#{agendaTrab.organos}" var="org" itemValue="#{org.codigo}" itemLabel="#{org.nombre}" />
					</p:selectOneMenu>
					<p:message for="somOrg" />
					
					<p:spacer width="20" height="20" />
					
					<h:outputLabel for="somDeman" value ="Demandante" />
					<p:autoComplete id="somDeman"
						value="#{agendaTrab.demandante}" 
						label="Responsable"
						completeMethod="#{agendaTrab.completeDemandante}" var="deman"
						converter="demandanteConverter" itemLabel="#{deman.persona.nombreCompleto}"
						itemValue="#{deman}" size="50">
					</p:autoComplete>
					<p:message for="somDeman" />
					
					<p:spacer width="20" height="20" />
					
					<h:outputLabel value="Prioridad"/>
					<p:selectOneMenu value="#{agendaTrab.idPrioridad}" id="somPrio">
						<f:selectItem itemLabel="Seleccione" itemValue="" />
						<f:selectItem itemLabel="Rojo" itemValue="R" />
						<f:selectItem itemLabel="Naranja" itemValue="N" />
						<f:selectItem itemLabel="Amarillo" itemValue="A" />
						<f:selectItem itemLabel="Verde" itemValue="V" />
					</p:selectOneMenu>
					<p:message for="somPrio" />


				</h:panelGrid>
				
				<h:panelGrid columns="9">
					<h:outputLabel value="Nro. de Expediente" />
					<p:inputMask value="#{agendaTrab.busNroExpe}"
						id="txtNroExpe" mask="aa9-999" style="height:20px;top:0px;width:100px;">
					</p:inputMask>

					<p:message id="msgNroExpeOficial" for="txtNroExpe" />

					<p:spacer width="20" height="20" />

					<h:outputLabel value="Responsable" for="somResp"/>
					<p:selectOneMenu value="#{agendaTrab.idResponsable}" id="somResp">
						<f:selectItem itemLabel="Seleccione" itemValue="" />
						<f:selectItems value="#{agendaTrab.responsables}" var="resp" itemValue="#{resp.idUsuario}" itemLabel="#{resp.nombreCompleto}" />
					</p:selectOneMenu>
					<p:message for="somResp" />
					
					<p:spacer width="50" height="20" />

					<p:commandButton value="Buscar" icon="ui-icon-search"
						actionListener="#{agendaTrab.buscarExpediente}"
						update="tableActPro" />
						
					<p:commandButton value="Enviar Correo Prueba" icon="ui-icon-mail-closed"
						actionListener="#{envioMail.enviarEmailCopiaAUno}"
						update="tableActPro" />

				</h:panelGrid>

             	<p:spacer width="20" height="20" />
             	
             	
				<p:dataTable value="#{agendaTrab.resultadoBusqueda}"
					id="tableActPro" var="actPro" 
					selectionMode="single"  
					selection="#{agendaTrab.busquedaProcesal}"
					emptyMessage="No hay registros"
					rows="10" paginator="true"
					paginatorTemplate="{FirstPageLink} {PreviousPageLink} {NextPageLink} {LastPageLink}"
					paginatorPosition="bottom" rowStyleClass="#{actPro.colorFila eq 'V' ? 'verdeOscuro' : null}
															  #{actPro.colorFila eq 'R' ? 'rojo' : null}
															  #{actPro.colorFila eq 'N' ? 'naranja' : null}
															  #{actPro.colorFila eq 'A' ? 'amarillo' : 'null'}" 
															  rowKey="#{actPro.id_expediente}">
															  
					<p:ajax event="rowSelect" listener="#{agendaTrab.editarExpediente}"/>
					
					<p:column headerText="Ver">
						<p:commandLink   value="Ver" update=":frmActProc:pnlVista"
            oncomplete="dialogWidget.show()"  >
						
						</p:commandLink>
					</p:column>
					
					<p:column headerText="Expediente" >
						<h:outputText value="#{actPro.nroExpediente}" />
					</p:column>
					<p:column headerText="Demandante">
						<!-- Si hubieran varios colocarlos separados por guiones -->
						<h:outputText value="#{actPro.demandante}" />
					</p:column>
					<p:column headerText="Organo">
						<h:outputText value="#{actPro.organo}" />
					</p:column>
					<p:column headerText="Hora">
						<h:outputText value="#{actPro.hora}" />
					</p:column>
					<p:column headerText="Actividad">
						<h:outputText value="#{actPro.actividad}" />
					</p:column>
					<p:column headerText="Responsable">
						<h:outputText value="#{actPro.usuario}" />
					</p:column>
					<p:column headerText="Fecha Actividad">
						<h:outputText value="#{actPro.fechaActividad}" />
					</p:column>
					<p:column headerText="Fecha Vencimiento">
						<h:outputText value="#{actPro.fechaVencimiento}" />
					</p:column>
					<p:column headerText="Fecha Atencion">
						<h:outputText value="#{actPro.fechaAtencion}" />
					</p:column>
					<p:column headerText="Observacion">
						<h:outputText value="#{actPro.observacion}" />
					</p:column>
				</p:dataTable>
				
				<p:panel header="Leyenda" id="paneleyenda" style="height:55px;left:0px;position:relative;top:0px;width:426px;left:703px;">
					<h:graphicImage library="images" name="bullet_red.jpg"/><p:spacer width="10" height="10" /> <h:outputLabel value="Actividad Vencida" style=""/>
					<p:spacer width="10" height="10" /><h:graphicImage library="images" name="bullet_orange.jpg"/><p:spacer width="10" height="10" /><h:outputLabel value="Actividad Critica"/>
					<p:spacer width="10" height="10" /><h:graphicImage library="images" name="bullet_yellow.jpg"/><p:spacer width="10" height="10" /><h:outputLabel value="Advertencia"/>
					<p:spacer width="10" height="10" /><h:graphicImage library="images" name="bullet_green.jpg"/><p:spacer width="10" height="10" /><h:outputLabel value="Normal"/>
				</p:panel>
				
				<p:dialog widgetVar="dialogWidget">
				<h2>Actualizacion y Seguimiento de Expediente</h2>

				<p:panel id="pnlVista">
					<p:accordionPanel id="accActExp">

						<p:tab title="#{msjs.datos_expe_titulo}">

							<h:panelGrid columns="11">

								<h:outputLabel for="txtNroExpeOficial"
									value="#{msjs.datos_expe_nro}" />
								<p:inputMask value="#{agendaTrab.busquedaProcesal.nroExpediente}"
									disabled="true" id="txtNroExpeOficial" required="true"
									label="Nro Expediente" title="Nro. Expediente Oficial"
									mask="aa9-999" size="7">
								</p:inputMask>
								<p:message id="msgNroExpeOficial" for="txtNroExpeOficial" />

</h:panelGrid>
</p:tab>
</p:accordionPanel>
					
				</p:panel>
					
					
		</p:dialog>
		
			</p:panel>
			
		</h:form>
		
		
		
	</ui:define>
</ui:composition>

</html>